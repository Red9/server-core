var spawn = require('child_process').spawn;
var path = require('path');

exports.panelReader = function (config) {
    console.log('###panelReader');
    function readPanelCSV(id) {
        var filename = path.join(config.dataPath, id) + '.RNC';
        var parameters = [
            '-i',
            filename
        ];

        var reader = spawn(config.command, parameters);
        reader.stdout.setEncoding('utf8');
        reader.stderr.setEncoding('utf8');

        reader.stderr.on('data', function (data) {
            console.log('Error: "' + data + '"');
        });

        reader.on('exit', function (code, signal) {
            if (code !== 0) {
                console.log('Error: ' + code);
            }
        });

        return reader.stdout;
    }

    return {
        readPanelCSV: readPanelCSV
    };
};




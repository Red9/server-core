<link rel="stylesheet" type="text/css" href="/stylesheets/jquery.dataTables.css">
<script src="/js/jquery.dataTables.js"></script>

<h1>{{page_title}}</h1>
<table class="table table-striped table-bordered" id="dataset_list">
    <thead>
        <tr>
            <th>Title</th>
            <th>User</th>
            <th>Created</th>
            <th>Duration</th>
            <th></th>
        </tr>
    </thead>
    <tbody>

        {{#each datasets}}   
        <tr id="dataset_list_row_{{{id}}}">
            <td>{{{name}}}</td>
            <td><a href="/user/{{{create_user.id}}}">{{{create_user.display_name}}}</a></td>
            <td>{{{create_time}}}</td>
            <td>{{{duration}}}</td>

            <td><a class="btn btn-xs btn-primary" href="/dataset/{{{id}}}">Go!</a>
                <a class="btn btn-xs btn-danger" onclick='deleteDataset("{{{id}}}")'>Delete</a>
            </td>
        </tr>
        {{/each}}

    </tbody>
</table>




<script>
                    var oTable;
                    $(document).ready(function() {
                        oTable = $('#dataset_list').dataTable({
                            "aaSorting": [[2, "desc"]],
                            "aLengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]]
                        });
                    });

                    function deleteDataset(id) {
                        $.ajax(
                                "/api/dataset/" + id,
                                {type: "delete"}
                        ).done(function() {
                            var row = $("#dataset_list_row_" + id);
                            row.addClass('danger');
                            row.hide("slow", function() {
                                oTable.fnDeleteRow(row[0]);
                            });
                        }
                        ).fail(function() {
                            alert("Internal Error: could not delete dataset. Please notify a sysadmin.");
                        });

                    }
</script>